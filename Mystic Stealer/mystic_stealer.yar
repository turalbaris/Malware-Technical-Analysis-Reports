import "hash"
rule MysticStealer_d
{
meta:
	author = " Barış Tural"
	description = "MysticStealer"
strings:
	$str1 = "HH:mm:ss" wide
	$str2 = "morda" 
	$str3 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
	$alg = {33 C8 2B D9 8B CB 8B C3 C1 E1 04 C1 E8 05}
	$ip_resolv = {80 C9 18 89 74 24 44 88 0D ?? ?? ?? ?? B8 F5 2A 00 00 0F B6 C9 66 33 C8 B8 D1 52 00 00 66 2B C8}
condition:
	hash.md5(0,filesize) == "e561df80d8920ae9b152ddddefd13c7c" or (2 of ($str*) and ($alg or $ip_resolv))
}


import "hash"
rule MysticStealer_s
{
meta:
	author = " Barış Tural"
	description = "MysticStealer"
strings:
	$str1 = "%d 1 JbzaUhs8q1"
	$str2 = "C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\AppLaunch.exe" wide
	$str3 = "GYAUs87atedyuw3"
	$str4 = "A8791hbx78iUA"
	$hashing_alg = {D1 E2 8B 45 E8 0F BE 0C 10 C1 E1 10 33 4D F8 89 4D F8}
	$anti_disass1 = {F8 73 02 E8 8B 68 13 15 C8 1D A1 ?? ?? ?? ?? 50 E8 20 30 FF FF}
	$anti_disass2 = {73 04 72 02 E8 A0 68 27 26 65 7B A1}
	$anti_disass3 = {E0 72 04 73 02 E9 9F 6A 04}
condition:
	all of them or hash.md5(0,filesize) == "692a59e85b4c932049ab55cb372a9509" or 3 of ($str*) and 2 of ($anti_disass*) or $hashing_alg
